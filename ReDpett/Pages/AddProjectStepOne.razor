@page "/add_project_step_1"

@using ReDpett.Pages.Components
@using ReDpett.Service

@inject NavigationManager NavigationManager;
@inject AppDataService data;

<div class="inner-page-wrapper">
    <div class="header-wrap">
        <div class="back-top-page">
            <span class="back-btn">
                <img src="images/black-arrow.svg" alt="img" />
            </span>
        </div>
    </div>
    <div class="add-project-adata-wrap">
        <div class="page-heading-wrap">
            <h2>ReDPeTT-Frontline</h2>
            <img src="images/border-svg.svg" alt="img" />
        </div>
        <div class="page-info-text">
            Recommendation: complete the Resident and Job &
            Site pages at the start of your cohort.
            Throughout your training, add new Projects (or update entries) as needed.
        </div>
        <div class="page-stepper-wrap">
            <div class="stepper-sepeat active-step">
                <div class="stepper-count-wrap">
                    <span>1</span>
                </div>
                <p>Resident </p>
            </div>
            <div class="stepper-sepeat">
                <div class="stepper-count-wrap">
                    <span>2</span>
                </div>
                <p>Job & Site</p>
            </div>
            <div class="stepper-sepeat">
                <div class="stepper-count-wrap">
                    <span>3</span>
                </div>
                <p>Projects</p>
            </div>
        </div>
        <div class="all-form-wraper">
            <div class="form-set-repeat">
                <div class="form-group">
                    <label>FETP *</label>
                    <select class="form-control " @bind=FETP>
                        <option>Select FETP</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Cohort Number *</label>
                    <select class="form-control " @bind=CohortNumber>
                        <option>Select</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Cohort Start Date</label>
                    <input type="date" @bind=CohortStartDate class="form-control date-cal" />
                </div>
                <div class="form-group">
                    <label>Cohort End Date</label>
                    <input type="date" @bind=CohortEndDate class="form-control date-cal" />
                </div>
            </div>
            <div class="form-set-repeat">
                <div class="page-heading-wrap">
                    <h2>Demographics</h2>
                    <img src="images/border-svg.svg" alt="img">
                </div>
                <div class="form-group">
                    <label>Resident Name</label>
                    <select class="form-control " @bind=ResidentName>
                        <option>Select</option>
                    </select>
                </div>
                <div class="form-group">
                    <label>Given/First Name</label>
                    <input type="text" placeholder="First Name" class="form-control " @bind=Given_FirstName />
                </div>
                <div class="form-group">
                    <label>Middle Name</label>
                    <input type="text" placeholder="Middle Name" class="form-control " @bind=MiddleName />
                </div>
                <div class="form-group">
                    <label>Surname /Last Name</label>
                    <input type="text" placeholder="Last Name" class="form-control " @bind=Sur_LastName />
                </div>
                <div class="form-group">
                    <label>Date of Birth *</label>
                    <input type="date" class="form-control date-cal" @bind=DOB />
                </div>
                <div class="form-group">
                    <label>Age</label>
                    <input type="text" placeholder="0" class="form-control " @bind=Age />
                </div>
                <div class="form-group">
                    <label>Sex *</label>
                    <select class="form-control " @bind=Sex>
                        <option value="">Select</option>
                        <option value="MALE">Male</option>
                        <option value="FEMALE">Female</option>
                        <option value="OTHERS">Other</option>
                    </select>
                </div>
            </div>
            <div class="form-set-repeat">
                <div class="page-heading-wrap">
                    <h2>Contact Information</h2>
                    <img src="images/border-svg.svg" alt="img">
                </div>
                <div class="form-group">
                    <label>Email</label>
                    <input type="email" placeholder="" class="form-control " @bind=Email />
                </div>
                <div class="form-group">
                    <label>Phone</label>
                    <input type="text" id="mobile_code" class="form-control" placeholder="" name="name" @bind=Phone>
                </div>
                <div class="form-button-wrap">
                    <button class="button primary-btn" @onclick=SaveData>Save</button>
                    <button class="button" @onclick=GoNextPage>Next</button>
                </div>
            </div>
        </div>
    </div>
    <Footer />
</div>

@code {

    public string FETP { get; set; }
    public string CohortNumber { get; set; }
    public DateTime CohortEndDate { get; set; }
    public DateTime CohortStartDate { get; set; }
    public string ResidentName { get; set; }
    public string Given_FirstName { get; set; }
    public string MiddleName { get; set; }
    public string Sur_LastName { get; set; }
    public DateTime DOB { get; set; }
    public int Age { get; set; }
    public string Sex { get; set; }
    public string Email { get; set; }
    public string Phone { get; set; }

    protected override void OnInitialized()
    {
        // Subscribe to the event
        NavigationManager.LocationChanged += LocationChanged;
        base.OnInitialized();
    }
    void LocationChanged(object sender, LocationChangedEventArgs e)
    {
        StateHasChanged();
    }

    private void GoNextPage()
    {
        SaveData();
        NavigationManager.NavigateTo("/add_project_step_2");
    }

    private void SaveData()
    {
        data.FETP = FETP;
        data.CohortNumber = CohortNumber;
        data.CohortEndDate = CohortEndDate.ToString();
        data.CohortStartDate = CohortStartDate.ToString();
        data.ResidentName = ResidentName;
        data.Given_FirstName = Given_FirstName;
        data.MiddleName = MiddleName;
        data.Sur_LastName = Sur_LastName;
        data.DOB = DOB.ToString();
        data.Age = Age;
        data.Sex = Sex;
        data.Email = Email;
        data.Phone = Phone;
    }
}
